<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>My Website</title>
    <link rel="icon" href="./favicon.ico" type="image/x-icon">
    <style>/*------ switch toggle ------*/ .switch {   position: relative;   display: inline-block;   width: 40px;   height: 20px; } .switch input {   opacity: 0;   width: 0;   height: 0; } .slider {   position: absolute;   cursor: pointer;   top: 0;   left: 0;   right: 0;   bottom: 0;   background-color: #ccc;   -webkit-transition: .4s;   transition: .4s; } .slider:before {     position: absolute;     content: "";     left: 5%;     bottom: 5%;     background-color: white;     -webkit-transition: .4s;     transition: .4s;     height: 90%;     aspect-ratio: 1/1; } input:checked + .slider {   background-color: #2196F3; } input:focus + .slider {   box-shadow: 0 0 1px #2196F3; } input:checked + .slider:before {   -webkit-transform: translateX(100%);   -ms-transform: translateX(100%);   transform: translateX(100%); } .slider.round {   border-radius: 9999px; } .slider.round:before {   border-radius: 50%; }</style>
    <style>/*------ wrappers ------*/ .horizontal-block { display: flex; width: fit-content; align-items: center; } .vertical-block { display: flex; justify-items: center; flex-direction: column; }</style>
    <script>async function Post(url, data) { try { url = "https://for-tests.onrender.com" + url; const response = await fetch(url, {method: 'POST', headers: {'Content-Type': 'application/json'}, body: JSON.stringify(data)}); if (!response.ok) throw new Error(`Ошибка: ${response.status}`); const result = await response.json(); return result;} catch (error) {console.error('Произошла ошибка при отправке запроса:', error); throw error;}}</script>
    <script>async function Get(url) { try { url = "https://for-tests.onrender.com" + url; const response = await fetch(url); if (!response.ok) throw new Error(`Ошибка: ${response.status}`); const result = await response.json(); return result;} catch (error) {console.error("Произошла ошибка при выполнении GET-запроса:", error); throw error;}}</script>
    <style>
      * {
        margin: 0;
        padding: 0;
        box-sizing: border-box;
        position: relative;
      }

      .hidden { display: none; }

      #name-input, #message-area {
        min-height: 24px; 
        font-size: 16px;
        border: none;
      }

      #name-input:focus, #message-area:focus {
        outline: none;
      }

      .sign {
        position: absolute;
        bottom: 5px;
        right: 5px;
        cursor: pointer;
      }

      .message-input {
        border: 1px solid gray;
        border-radius: 10px;
        overflow: hidden;
        max-width: 97vw;
        display: flex;
        width: fit-content;
        padding-bottom: 24px;
      }

      .message-input.no-sign { padding-bottom: 0px; }

      .resizable-wrapper {
        position: relative;
        display: inline-block;
      }
      
      textarea {
        resize: none; /* отключаем стандартное растягивание */
        width: 300px;
        height: 150px;
        padding: 10px;
        box-sizing: border-box;
      }
      
      .resizer {
        position: absolute;
        width: 16px;
        height: 16px;
        right: 5px;
        bottom: 5px;
        cursor: nwse-resize;
        border-bottom: 2px solid #7d7dbf;
        border-right: 2px solid #7d7dbf;
      }
    </style>
  </head>
  <body>
      <center><h1>Hello, put your message here:</h1></center>
      <form class="vertical-block" style="margin: 10px;min-width: 50px;">
        <div class="message-input no-sign">
          <div class="resizable-wrapper">
            <textarea id="message-area" style="width: 300px;max-width: 97vw;" name="message-text"></textarea>
            <div class="resizer"></div>
          </div>

          <div class="horizontal-block hidden sign" onclick="document.querySelector('#name-input').focus()"><h6>~</h6><input style="width: 10px;" name="message-author" id="name-input" oninput="resize()"></div>
        </div>
        
        <div class="horizontal-block" style="gap: 15px">
          <h5>dont want to give your name</h5>
          <label class="switch">
            <input type="checkbox" checked onchange="document.querySelector('#name-input').parentElement.classList.toggle('hidden');document.querySelector('.message-input').classList.toggle('no-sign');">
            <span class="slider round"></span>
          </label>
        </div>
      </form>
    <script>
      const textarea = document.querySelector("#message-area");
      const resizer = document.querySelector(".resizer");
      
      let isResizing = false;

      resizer.addEventListener("touchstart", e => {
        isResizing = true;
      }, { passive: true });
      
      resizer.addEventListener("mousedown", e => {
        isResizing = true;
        e.preventDefault();
      });
      
      document.addEventListener("mousemove", e => {
        if (isResizing) {
          textarea.style.width = e.clientX - textarea.offsetLeft + "px";
          textarea.style.height = e.clientY - textarea.offsetTop + "px";
          resize();
        }
      });
      
      document.addEventListener("mouseup", () => isResizing = false);
      document.addEventListener("touchend", () => isResizing = false);
      document.addEventListener("touchmove", e => {
        if (isResizing && e.touches[0]) {
          const touch = e.touches[0];
          textarea.style.width = touch.clientX - textarea.offsetLeft + "px";
          textarea.style.height = touch.clientY - textarea.offsetTop + "px";
          resize();
        }
      }, { passive: false });
      
      function resize() {
        const element = document.querySelector('#name-input');
        const maxWidth = parseInt(textarea.style.width);
        let attempts = 0;
        if (element.scrollWidth >= maxWidth - 10 && attempts++ < 30) { element.value = element.value.slice(0, -1) };
        element.style.width = "0px";
      }
    </script>
  </body>
</html>
